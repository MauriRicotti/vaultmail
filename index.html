<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>VaultMail - Gestor seguro de cuentas</title>

    <!-- Favicon -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="Assets/Logo VaultMail-Favicon.png"
    />

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />

    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="true" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <meta name="apple-mobile-web-app-title" content="VaultMail" />
    <meta name="theme-color" content="#7C3AED" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <!-- Estilos personalizados -->
    <link rel="stylesheet" href="style.css" />

    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css"
    />

    <!-- Popper.js para tooltips -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
  </head>

  <body>
    <!-- Pantalla de Login Fullscreen -->
    <!-- Pantalla de Acceso Concedido -->
    <div id="successScreen" class="success-screen d-none">
      <div class="success-screen-content">
        <div class="success-screen-icon">
          <i class="bi bi-check-circle"></i>
        </div>
        <h1 class="success-screen-title">¡Acceso Concedido!</h1>
        <p class="success-screen-message">
          Tu sesión se ha iniciado correctamente
        </p>
        <div class="success-screen-loader">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>

    <!-- Pantalla de Login Fullscreen -->
    <div id="loginScreen" class="login-screen d-none">
      <div class="login-screen-container">
        <!-- Columna izquierda (solo en PC) / Parte superior en mobile con logo -->
        <div class="login-screen-left">
          <div class="login-screen-left-content">
            <!-- Logo para mobile (se muestra con CSS en mobile) -->
            <div class="login-screen-logo-wrapper">
              <img
                src="Assets/Logo VaultMail.png"
                alt="VaultMail Logo"
                class="login-screen-logo"
              />
            </div>
            <!-- Texto solo en PC -->
            <h2 class="login-screen-tagline">VaultMail</h2>
            <p class="login-screen-description">
              Almacena y gestiona tus contraseñas de forma segura en un único
              lugar
            </p>
            <div class="login-screen-features">
              <div class="feature-item">
                <i class="bi bi-shield-lock"></i>
                <span>Encriptación 256-bit</span>
              </div>
              <div class="feature-item">
                <i class="bi bi-lock"></i>
                <span>Acceso seguro</span>
              </div>
              <div class="feature-item">
                <i class="bi bi-cloud-check"></i>
                <span>Sincronización automática</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Columna derecha (formulario) -->
        <div class="login-screen-right">
          <div class="login-screen-form-wrapper">
            <div class="login-screen-header">
              <h1 class="login-screen-title">Login</h1>
              <p class="login-screen-subtitle">Gestor seguro de cuentas</p>
            </div>

            <form id="loginForm" class="login-screen-form">
              <div class="login-screen-form-group">
                <label for="loginPassword" class="login-screen-label"
                  >Contraseña</label
                >
                <div class="login-screen-input-group">
                  <input
                    type="password"
                    class="login-screen-input"
                    id="loginPassword"
                    placeholder="••••••••"
                    required
                    autofocus
                  />
                  <button
                    class="login-screen-input-toggle"
                    type="button"
                    id="toggleLoginPassword"
                    tabindex="-1"
                  >
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
                <div class="login-screen-password-strength d-none">
                  <div class="strength-bar">
                    <div class="strength-fill" id="strengthFill"></div>
                  </div>
                  <small class="strength-text" id="strengthText"></small>
                </div>
                <small class="login-screen-helper-text">
                  Introduce tu contraseña para acceder
                </small>
              </div>

              <button type="submit" class="login-screen-btn-submit">
                <span class="btn-text">Acceder</span>
                <i class="bi bi-arrow-right"></i>
              </button>

              <div
                id="loginError"
                class="login-screen-alert login-screen-alert-error d-none"
                role="alert"
              ></div>
            </form>

            <div class="login-screen-footer">
              <p class="login-screen-info">
                <i class="bi bi-info-circle"></i>
                Tu contraseña no se almacena en servidores
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmación de Logout -->
    <div id="logoutConfirmModal" class="modal-logout d-none">
      <div class="modal-logout-overlay"></div>
      <div class="modal-logout-content">
        <div class="modal-logout-icon">
          <i class="bi bi-exclamation-circle"></i>
        </div>
        <h2 class="modal-logout-title">¿Cerrar Sesión?</h2>
        <p class="modal-logout-message">
          Tu sesión será cerrada y tendrás que iniciar sesión nuevamente
        </p>
        <div class="modal-logout-actions">
          <button
            class="modal-logout-btn modal-logout-cancel"
            id="cancelLogoutBtn"
          >
            Cancelar
          </button>
          <button
            class="modal-logout-btn modal-logout-confirm"
            id="confirmLogoutBtn"
          >
            Cerrar Sesión
          </button>
        </div>
      </div>
    </div>

    <!-- Header -->
    <header class="header">
      <div class="header-container">
        <div class="logo-section">
          <div class="logo">
            <img
              src="Assets/Logo VaultMail.png"
              alt="VaultMail Logo"
              class="logo-img"
            />
          </div>
          <div class="logo-text">
            <h1>VaultMail</h1>
            <p>Gestor seguro de cuentas</p>
          </div>
        </div>
        <div class="header-tagline">
          <span>Almacena seguro. Accede rápido.</span>
        </div>
        <div class="header-spacer"></div>
        <button class="logout-btn" id="logoutBtn" title="Cerrar sesión">
          <i class="bi bi-door-open"></i>
          <span class="logout-text">Cerrar sesión</span>
        </button>
        <button class="sidebar-toggle" id="sidebarToggle" title="Abrir menú">
          <i class="bi bi-list"></i>
        </button>
      </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h3>Navegación</h3>
        <div class="sidebar-header-buttons">
          <button
            class="sidebar-collapse-btn"
            id="sidebarCollapseBtn"
            title="Colapsar sidebar"
          >
            <i class="bi bi-chevron-left"></i>
          </button>
          <button class="sidebar-close" id="sidebarClose">
            <i class="bi bi-x"></i>
          </button>
        </div>
      </div>

      <div class="sidebar-content">
        <!-- Navigation Section -->
        <div class="sidebar-section">
          <nav class="sidebar-nav">
            <button
              class="sidebar-nav-item active"
              data-view="all"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Ver todas las cuentas"
            >
              <i class="bi bi-inbox"></i>
              <span class="sidebar-label">Todas las cuentas</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-view="favorites"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Ver solo favoritas"
            >
              <i class="bi bi-star-fill"></i>
              <span class="sidebar-label">Favoritas</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-view="inactive"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Ver archivadas"
            >
              <i class="bi bi-archive"></i>
              <span class="sidebar-label">Archivadas</span>
            </button>
          </nav>
        </div>

        <!-- Separator -->
        <div class="sidebar-section-divider"></div>

        <!-- Categories Section -->
        <div class="sidebar-section">
          <h4 class="sidebar-section-title">Categorías</h4>
          <nav class="sidebar-nav">
            <button
              class="sidebar-nav-item"
              data-category="streaming"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Streaming"
            >
              <i class="bi bi-play-circle-fill"></i>
              <span class="sidebar-label">Streaming</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="redes-sociales"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Redes Sociales"
            >
              <i class="bi bi-share"></i>
              <span class="sidebar-label">Redes Sociales</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="billetera-virtual"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Billetera Virtual"
            >
              <i class="bi bi-wallet-fill"></i>
              <span class="sidebar-label">Billetera Virtual</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="trabajo"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Trabajo"
            >
              <i class="bi bi-briefcase-fill"></i>
              <span class="sidebar-label">Trabajo</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="app"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="App"
            >
              <i class="bi bi-phone"></i>
              <span class="sidebar-label">App</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="video-juego"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Video Juego"
            >
              <i class="bi bi-controller"></i>
              <span class="sidebar-label">Video Juego</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="personal"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Personal"
            >
              <i class="bi bi-person-circle"></i>
              <span class="sidebar-label">Personal</span>
            </button>
            <button
              class="sidebar-nav-item"
              data-category="otros"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Otros"
            >
              <i class="bi bi-box-seam"></i>
              <span class="sidebar-label">Otros</span>
            </button>
          </nav>
        </div>

        <!-- Statistics Section -->
        <div class="sidebar-section">
          <h4 class="sidebar-section-title">Estadísticas</h4>
          <div class="sidebar-stats">
            <div
              class="sidebar-stat"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Total de cuentas"
            >
              <div class="sidebar-stat-value" id="sidebarTotalAccounts">0</div>
              <div class="sidebar-stat-label">Total</div>
            </div>
            <div class="sidebar-stat">
              <div class="sidebar-stat-value" id="sidebarActiveAccounts">0</div>
              <div class="sidebar-stat-label">En uso</div>
            </div>
            <div class="sidebar-stat">
              <div class="sidebar-stat-value" id="sidebarFavoritesCount">0</div>
              <div class="sidebar-stat-label">Favoritas</div>
            </div>
          </div>
        </div>

        <!-- Divider between Statistics and Actions -->
        <div class="sidebar-section-divider"></div>

        <!-- Actions Section -->
        <div class="sidebar-section">
          <h4 class="sidebar-section-title">Acciones</h4>
          <nav class="sidebar-nav">
            <button
              class="sidebar-nav-item"
              id="sidebarNewAccountBtn"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Nueva cuenta"
            >
              <i class="bi bi-plus-circle"></i>
              <span class="sidebar-label">Nueva Cuenta</span>
            </button>
            <button
              class="sidebar-nav-item"
              id="sidebarChangePasswordBtn"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Cambiar contraseña maestra"
            >
              <i class="bi bi-key"></i>
              <span class="sidebar-label">Cambiar Contraseña</span>
            </button>
            <button
              class="sidebar-nav-item"
              id="sidebarExportBtn"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Exportar cuentas"
            >
              <i class="bi bi-download"></i>
              <span class="sidebar-label">Exportar</span>
            </button>
            <button
              class="sidebar-nav-item"
              id="sidebarImportBtn"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Importar cuentas"
            >
              <i class="bi bi-upload"></i>
              <span class="sidebar-label">Importar</span>
            </button>
            <button
              class="sidebar-nav-item"
              id="sidebarHelpBtn"
              data-bs-toggle="tooltip"
              data-bs-placement="right"
              data-bs-title="Centro de ayuda"
            >
              <i class="bi bi-question-circle"></i>
              <span class="sidebar-label">Centro de Ayuda</span>
            </button>
          </nav>
          <div class="sidebar-actions-divider"></div>
          <button
            class="theme-toggle-sidebar"
            id="themeToggleSidebar"
            data-bs-toggle="tooltip"
            data-bs-placement="right"
            data-bs-title="Cambiar tema"
          >
            <i class="bi bi-moon"></i>
            <span>Cambiar Tema</span>
          </button>
          <button
            class="theme-toggle-sidebar"
            id="sidebarLogoutBtn"
            data-bs-toggle="tooltip"
            data-bs-placement="right"
            data-bs-title="Cerrar sesión"
          >
            <i class="bi bi-box-arrow-right"></i>
            <span>Cerrar Sesión</span>
          </button>
        </div>
      </div>

      <div class="sidebar-footer">
        <span class="sidebar-footer-text">VaultMail © 2025</span>
      </div>
    </aside>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Main Content -->
    <main class="main-container">
      <div class="page-title">
        <h2>Mis Cuentas</h2>
        <p>Organiza y administra tus cuentas de forma segura</p>
      </div>

      <!-- Search and Filters -->
      <div class="search-section">
        <div class="search-bar">
          <i class="bi bi-search"></i>
          <input
            type="text"
            id="searchInput"
            placeholder="Buscar por email o notas..."
          />
          <div class="search-bar-hint" id="searchBarHint">
            <kbd>Ctrl+K</kbd>
          </div>
          <button
            type="button"
            class="btn-clear-search"
            id="clearSearchBtn"
            style="display: none"
          >
            <i class="bi bi-x-circle"></i>
          </button>
        </div>
        <div class="filters">
          <select id="categoryFilter" class="filter-select">
            <option value="">Todas las categorías</option>
            <option value="streaming">Streaming</option>
            <option value="redes-sociales">Redes Sociales</option>
            <option value="billetera-virtual">Billetera Virtual</option>
            <option value="trabajo">Trabajo</option>
            <option value="app">App</option>
            <option value="video-juego">Video Juego</option>
            <option value="personal">Personal</option>
            <option value="otros">Otros</option>
          </select>
          <select id="statusFilter" class="filter-select">
            <option value="">Todos los estados</option>
            <option value="activa">En uso</option>
            <option value="inactiva">En desuso</option>
          </select>
          <button class="btn btn-primary" id="newAccountBtn">
            <span>+</span> Nueva Cuenta
          </button>
        </div>
      </div>

      <!-- Statistics Cards -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-value" id="totalAccounts">0</div>
          <div class="stat-label">Total de cuentas</div>
        </div>
        <div class="stat-card stat-card-active">
          <div class="stat-value" id="activeAccounts">0</div>
          <div class="stat-label">En uso</div>
        </div>
        <div class="stat-card stat-card-inactive">
          <div class="stat-value" id="inactiveAccounts">0</div>
          <div class="stat-label">En desuso</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="totalCategories">5</div>
          <div class="stat-label">Categorías</div>
        </div>
      </div>

      <!-- View Controls Bar -->
      <div class="view-controls-bar">
        <div class="view-controls-left">
          <button
            class="btn btn-control"
            id="toggleViewBtn"
            title="Cambiar vista"
          >
            <i class="bi bi-grid-3x3"></i>
            <span>Vista Cards</span>
          </button>
          <button
            class="btn btn-control"
            id="showFavoritesBtn"
            title="Mostrar solo favoritos"
          >
            <i class="bi bi-star"></i>
            <span>Favoritos</span>
          </button>
          <button
            class="btn btn-control"
            id="togglePasswordVisibilityBtn"
            title="Mostrar/Ocultar contraseñas"
          >
            <i class="bi bi-eye"></i>
            <span>Ver Contraseñas</span>
          </button>
          <button
            class="btn btn-control"
            id="showArchivedBtn"
            title="Mostrar cuentas archivadas"
          >
            <i class="bi bi-archive"></i>
            <span>Archivadas</span>
          </button>
        </div>
        <div class="view-controls-right">
          <button
            class="btn btn-control"
            id="exportBtn"
            title="Exportar cuentas"
          >
            <i class="bi bi-download"></i>
            <span>Exportar</span>
          </button>
          <button
            class="btn btn-control"
            id="importBtn"
            title="Importar cuentas"
          >
            <i class="bi bi-upload"></i>
            <span>Importar</span>
          </button>
        </div>
      </div>

      <!-- Accounts Container -->
      <div class="accounts-wrapper" id="accountsWrapper">
        <div class="accounts-container" id="accountsContainer">
          <div class="empty-state card">
            <div class="empty-state-content">
              <i class="bi bi-envelope-heart empty-state-icon"></i>
              <h3>No hay cuentas guardadas</h3>
              <p>Comienza agregando tu primera cuenta de Gmail</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Skeleton Loading Container -->
      <div class="skeleton-loader" id="skeletonLoader" style="display: none">
        <div class="skeleton-card">
          <div class="skeleton-header">
            <div class="skeleton-avatar"></div>
            <div class="skeleton-info">
              <div class="skeleton-title"></div>
              <div class="skeleton-text" style="width: 60%"></div>
            </div>
          </div>
          <div class="skeleton-body">
            <div class="skeleton-text"></div>
            <div class="skeleton-text" style="width: 80%"></div>
          </div>
          <div class="skeleton-footer">
            <div class="skeleton-button"></div>
            <div class="skeleton-button"></div>
          </div>
        </div>
        <div class="skeleton-card">
          <div class="skeleton-header">
            <div class="skeleton-avatar"></div>
            <div class="skeleton-info">
              <div class="skeleton-title"></div>
              <div class="skeleton-text" style="width: 60%"></div>
            </div>
          </div>
          <div class="skeleton-body">
            <div class="skeleton-text"></div>
            <div class="skeleton-text" style="width: 80%"></div>
          </div>
          <div class="skeleton-footer">
            <div class="skeleton-button"></div>
            <div class="skeleton-button"></div>
          </div>
        </div>
        <div class="skeleton-card">
          <div class="skeleton-header">
            <div class="skeleton-avatar"></div>
            <div class="skeleton-info">
              <div class="skeleton-title"></div>
              <div class="skeleton-text" style="width: 60%"></div>
            </div>
          </div>
          <div class="skeleton-body">
            <div class="skeleton-text"></div>
            <div class="skeleton-text" style="width: 80%"></div>
          </div>
          <div class="skeleton-footer">
            <div class="skeleton-button"></div>
            <div class="skeleton-button"></div>
          </div>
        </div>
      </div>
    </main>

    <!-- Hidden file input for import -->
    <input
      type="file"
      id="importFileInput"
      accept=".json"
      style="display: none"
    />

    <!-- Modal para nueva cuenta -->
    <div class="modal" id="accountModal">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title-section">
            <h2>Agregar Nueva Cuenta</h2>
            <p class="modal-description">
              Completa los datos de tu cuenta de Gmail
            </p>
          </div>
          <button class="modal-close" id="closeModal">&times;</button>
        </div>
        <form id="accountForm">
          <div class="form-group">
            <label for="email">Correo electrónico</label>
            <div class="email-input-wrapper">
              <input type="text" id="email" required placeholder="tu-email" />
              <span class="email-suffix" id="emailSuffix">@gmail.com</span>
            </div>
          </div>
          <div class="form-group">
            <label for="password">Contraseña</label>
            <input
              type="password"
              id="password"
              required
              placeholder="••••••••"
            />
          </div>
          <div class="form-group">
            <label for="notes">Notas (opcional)</label>
            <textarea
              id="notes"
              placeholder="Agrega notas sobre esta cuenta..."
            ></textarea>
          </div>
          <div class="form-group">
            <label for="category">Categoría</label>
            <select id="category" required>
              <option value="">Selecciona una categoría</option>
              <option value="streaming">Streaming</option>
              <option value="redes-sociales">Redes Sociales</option>
              <option value="billetera-virtual">Billetera Virtual</option>
              <option value="trabajo">Trabajo</option>
              <option value="app">App</option>
              <option value="video-juego">Video Juego</option>
              <option value="personal">Personal</option>
              <option value="otros">Otros</option>
            </select>
          </div>
          <div class="form-group form-group-checkbox">
            <label>
              <input type="checkbox" id="status" checked />
              <span>Cuenta en uso</span>
            </label>
          </div>
          <div class="form-group" id="inactiveUntilGroup" style="display: none">
            <label for="inactiveUntil">En desuso hasta (opcional)</label>
            <input
              type="date"
              id="inactiveUntil"
              placeholder="Selecciona una fecha"
            />
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-secondary" id="cancelBtn">
              Cancelar
            </button>
            <button type="submit" class="btn btn-primary">
              Guardar Cuenta
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal para ver cuenta -->
    <div class="modal" id="viewModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Detalles de la Cuenta</h2>
          <button class="modal-close" id="closeViewModal">&times;</button>
        </div>
        <div id="viewAccountContent"></div>
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" id="deleteBtn">
            Eliminar
          </button>
          <button type="button" class="btn btn-primary" id="editBtn">
            Guardar Cambios
          </button>
          <button type="button" class="btn btn-secondary" id="closeViewBtn">
            Cerrar
          </button>
        </div>
      </div>
    </div>

    <!-- Modal para cambiar contraseña -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1">
      <div
        class="modal-dialog modal-dialog-centered change-password-modal-dialog"
      >
        <div class="modal-content change-password-modal-content">
          <div class="modal-header change-password-header">
            <h5 class="modal-title">Cambiar Contraseña</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body change-password-body">
            <form id="changePasswordForm">
              <div class="change-password-form-group">
                <label for="currentPassword" class="change-password-label"
                  >Contraseña Actual</label
                >
                <div class="change-password-input-group">
                  <input
                    type="password"
                    class="change-password-input"
                    id="currentPassword"
                    placeholder="••••••••"
                    required
                  />
                  <button
                    class="change-password-input-toggle"
                    type="button"
                    id="toggleCurrentPassword"
                    tabindex="-1"
                  >
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
              </div>

              <div class="change-password-form-group">
                <label for="newPassword" class="change-password-label"
                  >Nueva Contraseña</label
                >
                <div class="change-password-input-group">
                  <input
                    type="password"
                    class="change-password-input"
                    id="newPassword"
                    placeholder="••••••••"
                    required
                  />
                  <button
                    class="change-password-input-toggle"
                    type="button"
                    id="toggleNewPassword"
                    tabindex="-1"
                  >
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
              </div>

              <div class="change-password-form-group">
                <label for="confirmPassword" class="change-password-label"
                  >Confirmar Contraseña</label
                >
                <div class="change-password-input-group">
                  <input
                    type="password"
                    class="change-password-input"
                    id="confirmPassword"
                    placeholder="••••••••"
                    required
                  />
                  <button
                    class="change-password-input-toggle"
                    type="button"
                    id="toggleConfirmPassword"
                    tabindex="-1"
                  >
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
              </div>

              <div
                id="changePasswordError"
                class="change-password-alert change-password-alert-error d-none"
                role="alert"
              ></div>
              <div
                id="changePasswordSuccess"
                class="change-password-alert change-password-alert-success d-none"
                role="alert"
              ></div>
            </form>
          </div>
          <div class="modal-footer change-password-footer">
            <button
              type="button"
              class="change-password-btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="change-password-btn-primary"
              id="changePasswordSubmitBtn"
            >
              Cambiar Contraseña
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Confirmación de Eliminación -->
    <div
      class="modal fade"
      id="deleteConfirmModal"
      tabindex="-1"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered delete-confirm-modal">
        <div class="modal-content delete-confirm-content">
          <div class="modal-header delete-confirm-header">
            <h5 class="modal-title">
              <i class="bi bi-exclamation-triangle"></i> Confirmar Eliminación
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body delete-confirm-body">
            <p class="delete-confirm-text">
              ¿Estás seguro de que deseas eliminar esta cuenta?
            </p>
            <p
              class="delete-confirm-account-name"
              id="deleteConfirmAccountName"
            >
              Cuenta: <strong></strong>
            </p>
            <div
              class="delete-confirm-category"
              style="
                padding: 0.5rem 1rem;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                margin: 0.75rem 0;
              "
            ></div>
            <div class="delete-confirm-warning">
              <i class="bi bi-info-circle"></i>
              <span>Esta acción no se puede deshacer</span>
            </div>
          </div>
          <div class="modal-footer delete-confirm-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
              <i class="bi bi-trash"></i> Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para confirmar duplicados -->
    <div
      class="modal fade"
      id="duplicateConfirmModal"
      tabindex="-1"
      data-bs-backdrop="static"
      data-bs-keyboard="false"
    >
      <div class="modal-dialog modal-dialog-centered delete-confirm-modal">
        <div class="modal-content delete-confirm-content">
          <div class="modal-header delete-confirm-header">
            <h5 class="modal-title">
              <i class="bi bi-exclamation-circle"></i> Cuenta Duplicada
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body delete-confirm-body">
            <p class="delete-confirm-text">
              Esta cuenta ya existe en tu sistema
            </p>
            <p
              class="delete-confirm-account-name"
              id="duplicateConfirmAccountName"
            >
              Correo: <strong></strong>
            </p>
            <div
              class="duplicate-confirm-category"
              style="
                padding: 0.5rem 1rem;
                border-radius: 8px;
                color: white;
                font-weight: 600;
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                margin: 0.75rem 0;
              "
            ></div>
            <div class="delete-confirm-warning">
              <i class="bi bi-info-circle"></i>
              <span>¿Deseas guardar esta cuenta de todas formas?</span>
            </div>
          </div>
          <div class="modal-footer delete-confirm-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Cancelar
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="confirmDuplicateBtn"
            >
              <i class="bi bi-check"></i> Guardar de Todas Formas
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para ayuda e información -->
    <div class="modal" id="helpModal">
      <div class="modal-content modal-help">
        <div class="modal-header">
          <h2>Centro de Ayuda</h2>
          <button class="modal-close" id="closeHelpModal">&times;</button>
        </div>
        <div class="help-content">
          <!-- Tabs for help sections -->
          <div class="help-tabs">
            <button class="help-tab-btn active" data-tab="inicio">
              <i class="bi bi-house"></i> Inicio
            </button>
            <button class="help-tab-btn" data-tab="caracteristicas">
              <i class="bi bi-star"></i> Características
            </button>
            <button class="help-tab-btn" data-tab="atajos">
              <i class="bi bi-keyboard"></i> Atajos
            </button>
          </div>

          <!-- Tab Content -->
          <div class="help-tab-content">
            <!-- Inicio -->
            <div class="help-section active" data-section="inicio">
              <h3>Bienvenido a VaultMail</h3>
              <p>
                VaultMail es un gestor seguro de cuentas de Gmail diseñado para
                ayudarte a organizar y administrar todas tus cuentas de correo
                en un solo lugar de forma segura y eficiente.
              </p>
              <div class="help-box">
                <h4><i class="bi bi-key"></i> Sistema de Login</h4>
                <p>
                  La primera vez que accedas, establece una contraseña maestra.
                  Esta contraseña protege todas tus cuentas guardadas. Recuerda
                  mantenerla segura y en un lugar seguro.
                </p>
                <ul>
                  <li>Se requiere contraseña para acceder a VaultMail</li>
                  <li>Tus datos se desbloquean solo con esta contraseña</li>
                  <li>La contraseña se encripta localmente en tu navegador</li>
                </ul>
              </div>
              <div class="help-box">
                <h4>
                  <i class="bi bi-arrow-left-right"></i> Cambiar Contraseña
                </h4>
                <p>
                  Puedes cambiar tu contraseña maestra en cualquier momento
                  desde el menú lateral. Necesitarás confirmar tu contraseña
                  actual.
                </p>
                <ul>
                  <li>Haz clic en "Cambiar Contraseña" en el menú lateral</li>
                  <li>Introduce tu contraseña actual para verificación</li>
                  <li>Ingresa la nueva contraseña y confírmala</li>
                  <li>Los cambios se aplican inmediatamente</li>
                </ul>
              </div>
              <div class="help-box">
                <h4><i class="bi bi-plus-circle"></i> ¿Cómo comenzar?</h4>
                <ol>
                  <li>
                    Haz clic en <strong>"+ Nueva Cuenta"</strong> para agregar
                    tu primera cuenta
                  </li>
                  <li>Completa los datos: correo, contraseña y categoría</li>
                  <li>Tus datos se guardan automáticamente en tu navegador</li>
                  <li>Organiza tus cuentas usando categorías y favoritos</li>
                </ol>
              </div>
            </div>

            <!-- Características -->
            <div class="help-section" data-section="caracteristicas">
              <h3>Características Principales</h3>
              <div class="help-feature">
                <h4><i class="bi bi-folder"></i> Categorización</h4>
                <p>
                  Organiza tus cuentas en diferentes categorías: Streaming,
                  Redes Sociales, Billetera Virtual, Trabajo, App, Video Juego,
                  Personal y Otros.
                </p>
              </div>
              <div class="help-feature">
                <h4><i class="bi bi-star-fill"></i> Favoritos</h4>
                <p>
                  Marca tus cuentas más usadas como favoritas para acceder
                  rápidamente a ellas.
                </p>
              </div>
              <div class="help-feature">
                <h4><i class="bi bi-search"></i> Búsqueda y Filtros</h4>
                <p>
                  Busca cuentas por correo o notas, filtra por categoría y
                  estado de uso.
                </p>
              </div>
              <div class="help-feature">
                <h4><i class="bi bi-archive"></i> Archivado</h4>
                <p>
                  Archiva cuentas que no usas frecuentemente sin eliminarlas.
                </p>
              </div>
              <div class="help-feature">
                <h4><i class="bi bi-download"></i> Exportar/Importar</h4>
                <p>
                  Descarga tus datos como JSON o importa cuentas desde un
                  archivo.
                </p>
              </div>
              <div class="help-feature">
                <h4><i class="bi bi-sun"></i> Tema Claro/Oscuro</h4>
                <p>
                  Cambia entre modo claro y oscuro para mayor comodidad visual.
                </p>
              </div>
            </div>

            <!-- Atajos de Teclado -->
            <div class="help-section" data-section="atajos">
              <h3>Atajos de Teclado</h3>
              <p>Usa estos atajos para navegar más rápidamente:</p>
              <div class="shortcuts-table">
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + A</div>
                  <div class="shortcut-desc">Agregar nueva cuenta</div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + B</div>
                  <div class="shortcut-desc">Expandir/Comprimir sidebar</div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + K</div>
                  <div class="shortcut-desc">Enfoca la barra de búsqueda</div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + T</div>
                  <div class="shortcut-desc">Cambiar tema (claro/oscuro)</div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + F</div>
                  <div class="shortcut-desc">Mostrar solo favoritos</div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + Alt + ←</div>
                  <div class="shortcut-desc">
                    Ir a página anterior (paginación)
                  </div>
                </div>
                <div class="shortcut-item">
                  <div class="shortcut-keys">Ctrl + Alt + →</div>
                  <div class="shortcut-desc">
                    Ir a página siguiente (paginación)
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="footer-container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>VaultMail</h3>
            <p>
              Organiza y administra tus cuentas de Gmail de forma segura con
              VaultMail. Todos los datos se guardan localmente en tu navegador.
            </p>
          </div>
          <div class="footer-section">
            <h4>Características</h4>
            <ul>
              <li>Almacenamiento seguro local</li>
              <li>Categorización de cuentas</li>
              <li>Búsqueda y filtros avanzados</li>
              <li>Gestión de estado de uso</li>
            </ul>
          </div>
          <div class="footer-section">
            <h4>Privacidad</h4>
            <p>
              Esta aplicación no envía datos a ningún servidor. Todo permanece
              en tu dispositivo.
            </p>
            <div class="footer-icons">
              <a href="#" aria-label="GitHub" title="GitHub">
                <i class="bi bi-github"></i>
              </a>
              <a href="#" aria-label="Twitter" title="Twitter">
                <i class="bi bi-twitter"></i>
              </a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          <p>&copy; 2025 VaultMail. Todos los derechos reservados.</p>
          <p>
            Creado por
            <a
              href="https://nexcore-gamma.vercel.app/"
              target="_blank"
              rel="noopener noreferrer"
              >Nexcore</a
            >
          </p>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="main.js"></script>

    <!-- Service Worker Registration para PWA/Offline -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then((registration) => {
              console.log(
                "[App] Service Worker registrado exitosamente:",
                registration
              );

              // Detectar actualizaciones disponibles
              registration.addEventListener("updatefound", () => {
                const newWorker = registration.installing;
                newWorker.addEventListener("statechange", () => {
                  if (
                    newWorker.state === "installed" &&
                    navigator.serviceWorker.controller
                  ) {
                    console.log(
                      "[App] Nueva versión disponible. Actualizar..."
                    );
                    // Aquí podrías mostrar una notificación al usuario
                  }
                });
              });
            })
            .catch((error) => {
              console.error("[App] Error al registrar Service Worker:", error);
            });
        });
      }

      // Detectar cambios en conexión
      window.addEventListener("online", () => {
        console.log("[App] Conexión a internet restaurada");
        document.body.classList.remove("offline-mode");
      });

      window.addEventListener("offline", () => {
        console.log("[App] Sin conexión a internet - Modo offline activado");
        document.body.classList.add("offline-mode");
      });

      // Verificar estado inicial
      if (!navigator.onLine) {
        document.body.classList.add("offline-mode");
      }
    </script>
  </body>
</html>
